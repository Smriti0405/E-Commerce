
<% layout('layout/boilerplate') -%>

<div class="row">

  <%- include("../partials/flash") %>

    <% for(let item of products){ %>
        <div class="col-lg-4">
            <div class="card shadow-sm mx-auto mb-4" style="width: 20rem;">
                <img src="<%= item.img %>" class="card-img-top img-thumbnail" alt="item image" style="height: 15rem;">
                <span class="badge rounded-pill bg-light text-dark w-25 position-absolute translate-middle-y" style="top:50%;left:5%"><%=item.avgRating%>  &star; | <%=item.reviews.length%></span>
                <div class="card-body">
                  <h4 class="card-title d-flex justify-content-between align-items-center"> 
                    <span><%= item.name %></span>
                    <span class="btn like-button" product-id="<%=item._id%>">
                      <% if(currentUser && currentUser.wishList.includes(item._id)){ %> 
                        <i class="fas fa-heart"></i>
                    <% }else {%>
                        <i class="far fa-heart"></i>
                    <% } %>
                    </span>
                  </h4>
                  <% if(item.reviews.length){ %>
                    <p class="text-muted"><%=item.reviews.length%> reviews</p>
                  <%}else{%>
                    <p class="text-muted">No reviews</p>
                  <% } %>
                  <h5 class="card-title">Rs. <%= item.price %></h5>
                  <a href="/products/<%= item._id %>" class="btn btn-sm btn-primary">Buy Now</a>
                </div>
            </div>
        </div>
    <%}%>
</div>


<script src="/js/common.js"></script>